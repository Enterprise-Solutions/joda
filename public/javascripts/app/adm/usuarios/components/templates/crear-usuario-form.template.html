
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <h4 class="text-info">
                Nuevo Usuario
            </h4>
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-push-10 col-md-2">
                    <button type="button" class="btn btn-default" (click)="volver()">
                        Volver
                    </button>
                </div>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <form (ngSubmit)="onSubmit()" #crearUsuarioForm="ngForm">
        <div *ngIf="crearNuevaPersona">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="nombres">Nombre/s</label>
                        <input id="nombres" type="text" class="form-control" required
                               [(ngModel)]="persona.nombres" 
                               ngControl="nombres" #nombres="ngModel"
                               name="nombres">
                        <div [hidden]="nombres.valid || nombres.untouched" class="alert alert-danger">
                            El nombre es obligatorio.
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-group">
                        <label for="apellidos">Apellido/s</label>
                        <input id="apellidos" type="text" class="form-control" required
                               [(ngModel)]="persona.apellidos" 
                               ngControl="apellidos" #apellidos="ngModel"
                               name="apellidos">
                        <div [hidden]="apellidos.valid || apellidos.untouched" class="alert alert-danger">
                            El apellido es obligatorio.
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Fecha de Nacimiento</label>
                        <!--<input id="fecha_de_nacimiento" type="text" class="form-control" data-provide="datepicker"
                               [(ngModel)]="persona.fecha_de_nacimiento" ngControl="fecha_de_nacimiento" #fechaNac
                               data-target="#fecha_de_nacimiento" >-->
                        <my-date-picker [options]="myDatePickerOptions"
                                        (dateChanged)="onDateChanged($event)"
                                        [selDate]="hoy"></my-date-picker>

                    </div>
                </div>
            </div>
            <br>

            <fieldset>
                <legend class="text-info"><i class="fa fa-credit-card-alt fa-fw"></i> Documento Principal</legend>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="documento">Nro. Documento</label>
                            <input id="documento" type="text" class="form-control" required
                                   [(ngModel)]="persona.doc.documento" 
                                   ngControl="documento" #documento="ngModel"
                                   name="documento">
                            <div [hidden]="documento.valid || documento.untouched" class="alert alert-danger">
                                El Documento es obligatorio.
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="org_documento_tipo_id">Tipo de Documento</label>
                            <select id="org_documento_tipo_id" class="form-control" required
                                    [(ngModel)]="persona.doc.org_documento_tipo_id" 
                                    ngControl="org_documento_tipo_id" 
                                    #org_documento_tipo_id="ngModel"
                                    name="org_documento_tipo_id">
                                <option *ngFor="let tipo of tipoDocumentos" [value]="tipo.id">{{tipo.nombre}}</option>
                            </select>
                            <div [hidden]="org_documento_tipo_id.valid || org_documento_tipo_id.untouched" class="alert alert-danger">
                                El Tipo de Documento es Obligatorio.
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>

        <div *ngIf="!crearNuevaPersona">
            <div class="row">
                <div class="col-md-12">
                    <h3 class="text-info"><i class="fa fa-user fa-fw"></i> Persona</h3>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3"><label>Nombre/s</label></div>
                <div class="col-md-9">{{persona.nombres}}</div>
            </div>
            <div class="row">
                <div class="col-md-3"><label>Apellido/s</label></div>
                <div class="col-md-9">{{persona.apellidos}}</div>
            </div>
            <div class="row">
                <div class="col-md-3"><label>Fecha de Nacimiento</label></div>
                <div *ngIf="persona.fecha_de_nacimiento" class="col-md-9">{{persona.fecha_de_nacimiento}}</div>
                <div *ngIf="!persona.fecha_de_nacimiento" class="col-md-9">-</div>
            </div>
        </div>

        <br>
        <fieldset>
            <legend class="text-info"><i class="fa fa-user fa-fw"></i> Datos de Usuario</legend>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input id="email" type="email" class="form-control" required
                               [(ngModel)]="usuario.email" 
                               ngControl="email" #email="ngModel"
                               name="email">
                        <div [hidden]="email.valid || email.untouched" class="alert alert-danger">
                            El email obligatorio.
                        </div>
                    </div>
                </div>
            </div>

            <br>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="password">Contraseña</label>
                        <input id="password" type="password" class="form-control" required
                               [(ngModel)]="usuario.password" 
                               ngControl="password" #password="ngModel"
                               name="password">
                        <div [hidden]="password.valid || password.untouched" class="alert alert-danger">
                            El password es obligatorio.
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="confirm_password">Repetir Contraseña</label>
                        <input id="confirm_password" type="password" class="form-control" required
                               [(ngModel)]="usuario.confirmar_pass" 
                               ngControl="confirm_password" 
                               #confirm_password="ngModel"
                               name="confirm_password">
                        <div [hidden]="confirm_password.valid || confirm_password.untouched" class="alert alert-danger">
                            Es obligatorio insertar de vuelta el password.
                        </div>
                        <div [hidden]="passwordIguales" class="alert alert-danger">
                            Las contraseñas no coinciden
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="estado">Estado</label>
                        <select id="estado" class="form-control" required
                                [(ngModel)]="estadoSeleccionado" 
                                ngControl="estado" 
                                #estado="ngModel"
                                name="estado">
                            <option *ngFor="let estado of estados" [value]="estado.id">{{estado.estado}}</option>
                        </select>
                        <div [hidden]="estado.valid || estado.untouched" class="alert alert-danger">
                            El estado es obligatorio.
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>

        <div class="row">
            <div class="col-md-12">
                <button class="btn btn-info" type="submit" [disabled]="!crearUsuarioForm.form.valid">Guardar</button>
                <button class="btn btn-default" type="button" (click)="volver()">Cancelar</button>
            </div>
        </div>
    </form>

    <!-- Mensaje -->
    <div id="message">
        <div class="container-fluid" >
            <div id="inner-message">
                <div  class="alert alert-success" [hidden]="!mostrarMensajeExito">
                    <strong>{{mensajeAlerta}}</strong>
                </div>

                <div  class="alert alert-danger" [hidden]="!mostrarMensajeError">
                    <!--<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>-->
                    <strong> {{mensajeAlerta}} &nbsp; &nbsp; &nbsp;</strong>
                </div>
            </div>
        </div>
    </div>
</div>